DROP TABLE SoldVia;
DROP TABLE Payment;
DROP TABLE Booking;
DROP TABLE CheckOut;
DROP TABLE CheckIn;
DROP TABLE GuestPhone;
DROP TABLE Guest;
DROP TABLE Room;
DROP TABLE Building;
DROP TABLE Hotel;



CREATE TABLE Hotel( HId INT PRIMARY KEY NOT NULL , HName VARCHAR(20) NOT NULL);

CREATE TABLE Building( BuildId VARCHAR(3) NOT NULL , City VARCHAR(20) NOT NULL, Country VARCHAR(20)NOT NULL, NumOfFloors INT NOT NULL,PRIMARY KEY(BuildId), HId INT REFERENCES Hotel(HId));

CREATE TABLE Room(RoomNo VARCHAR(3) NOT NULL, NumOfBeds INT NOT NULL, PRIMARY KEY(RoomNo, BuildId), BuildId VARCHAR(3) REFERENCES Building(BuildId));

CREATE TABLE Guest(GId INT NOT NULL, FName VARCHAR(20) NOT NULL, LName VARCHAR(20)NOT NULL, Email VARCHAR(40) NOT NULL, DateOfBirth DATE NOT NULL, ReferId INT NULL, PRIMARY KEY(GId), FOREIGN KEY(ReferId) REFERENCES Guest(GId));

CREATE TABLE GuestPhone(PhoneNumber Numeric(15) NOT NULL, GId INT REFERENCES Guest(GId));

CREATE TABLE CheckIn(CheckInTime TIME(0) NOT NULL, CheckInDate DATE NOT NULL, GId INT REFERENCES Guest(GId), BuildId VARCHAR(3) REFERENCES Building(BuildId)); 

CREATE TABLE CheckOut( CheckOutTime TIME(0) NOT NULL, CheckOutDate DATE NOT NULL, GId INT REFERENCES Guest(GId), BuildId VARCHAR(3) REFERENCES Building(BuildId));  

CREATE TABLE Booking(BookId VARCHAR(7) NOT NULL, BookDate DATE NOT NULL, PRIMARY KEY(BookId), HId INT REFERENCES Hotel(HId));

CREATE TABLE Payment(PId INT NOT NULL, Method VARCHAR(20) NOT NULL, CNumber VARCHAR(15) UNIQUE NOT NULL, PRIMARY KEY(PId), GId INT REFERENCES Guest(GId));

CREATE TABLE SoldVia(BookId VARCHAR(7) REFERENCES Booking(BookId), PId INT REFERENCES Payment(PId), PRIMARY KEY (BookId,PId));


 INSERT INTO Hotel VALUES(100, 'Arlade');
 INSERT INTO Hotel VALUES(101, 'Belmade');
 INSERT INTO Hotel VALUES(102, 'Crowder');
 INSERT INTO Hotel VALUES(103, 'Delmane');
 INSERT INTO Hotel VALUES(104, 'Fremane');
 INSERT INTO Hotel VALUES(105, 'Grame');
 INSERT INTO Hotel VALUES(106, 'Halmone');
 INSERT INTO Hotel VALUES(107, 'Jasmone');
 INSERT INTO Hotel VALUES(108, 'Kelmone');
 INSERT INTO Hotel VALUES(109, 'Orgrade');

 INSERT INTO Building VALUES('A90', 'Atlanta', 'United States', 8, 100);
 INSERT INTO Building VALUES('A91', 'Denver', 'United States', 6, 101);
 INSERT INTO Building VALUES('A92', 'Hong Kong', 'Hong Kong', 12, 102);
 INSERT INTO Building VALUES('A93', 'Newark', 'United States', 9, 103);
 INSERT INTO Building VALUES('A94', 'Ibadan', 'Nigeria', 5, 104);
 INSERT INTO Building VALUES('A95', 'Ottawa', 'Canada', 10, 105);
 INSERT INTO Building VALUES('A96', 'Munich', 'Germany', 11, 106);
 INSERT INTO Building VALUES('A97', 'Newcastle', 'United Kingdom', 8, 107);
 INSERT INTO Building VALUES('A98', 'Milan', 'Italy', 11, 108);
 INSERT INTO Building VALUES('A99', 'Accra', 'Ghana', 6, 109);


 INSERT INTO Room VALUES('90A', 1, 'A90');
 INSERT INTO Room VALUES('90B', 1, 'A90');
 INSERT INTO Room VALUES('91A', 1, 'A91');
 INSERT INTO Room VALUES('91B', 2, 'A91');
 INSERT INTO Room VALUES('92A', 1, 'A92');
 INSERT INTO Room VALUES('92B', 3, 'A92');
 INSERT INTO Room VALUES('93A', 1, 'A93');
 INSERT INTO Room VALUES('93B', 1, 'A93');
 INSERT INTO Room VALUES('94A', 2, 'A94');
 INSERT INTO Room VALUES('94B', 1, 'A94');
 INSERT INTO Room VALUES('95A', 2, 'A95');
 INSERT INTO Room VALUES('95B', 2, 'A95');
 INSERT INTO Room VALUES('96A', 1, 'A96');
 INSERT INTO Room VALUES('96B', 1, 'A96');
 INSERT INTO Room VALUES('97A', 3, 'A97');
 INSERT INTO Room VALUES('97B', 1, 'A97');
 INSERT INTO Room VALUES('98A', 2, 'A98');
 INSERT INTO Room VALUES('98B', 1, 'A98');
 INSERT INTO Room VALUES('99A', 2, 'A99');
 INSERT INTO Room VALUES('99B', 2, 'A99');

 INSERT INTO Guest VALUES(10, 'Caleb', 'Oke', 'Seyioke30@gmail.com', '1999-05-11',NULL);
 INSERT INTO Guest VALUES(11, 'John', 'Paul', 'JohnPaul70@gmail.com', '1983-06-15',10);
 INSERT INTO Guest VALUES(12, 'Jim', 'Berkley', 'jimberkle830@gmail.com', '1995-03-21',11);
 INSERT INTO Guest VALUES(13, 'Lionel', 'Graham', 'Lionelgraham@gmail.com', '1976-04-21',NULL);
 INSERT INTO Guest VALUES(14, 'Raheem', 'Ronaldo', 'raheemronaldo@gmail.com', '1984-05-14',13);
 INSERT INTO Guest VALUES(15, 'Carlos', 'Arguero', 'carlosarguero@gmail.com', '1993-08-21',12);
 INSERT INTO Guest VALUES(16, 'Rachel', 'Morris', 'rachelmorris@gmail.com', '1995-05-17',10);
 INSERT INTO Guest VALUES(17, 'Morgan', 'Freckle', 'Morganfreckle@gmail.com', '1991-05-20',14);
 INSERT INTO Guest VALUES(18, 'Fred', 'Welbeck', 'FredWelbeck@gmail.com', '1995-05-18',15);
 INSERT INTO Guest VALUES(19, 'Mesut', 'Dyke', 'MesutDyke@gmail.com', '1979-12-09',10);

 INSERT INTO GuestPhone VALUES('+13342797641', 10);
 INSERT INTO GuestPhone VALUES('+13342249869', 10);
 INSERT INTO GuestPhone VALUES('+17297751230', 11);
 INSERT INTO GuestPhone VALUES('+17295539807', 11);
 INSERT INTO GuestPhone VALUES('+17625123345', 12);
 INSERT INTO GuestPhone VALUES('+17627779812', 12);
 INSERT INTO GuestPhone VALUES('+16125540981', 13);
 INSERT INTO GuestPhone VALUES('+16127754321', 13);
 INSERT INTO GuestPhone VALUES('+19125543321', 14);
 INSERT INTO GuestPhone VALUES('+19127651234', 14);
 INSERT INTO GuestPhone VALUES('+18246549901', 15);
 INSERT INTO GuestPhone VALUES('+18247761265', 15);
 INSERT INTO GuestPhone VALUES('+17728651209', 16);
 INSERT INTO GuestPhone VALUES('+17723450912', 16);
 INSERT INTO GuestPhone VALUES('+15138883452', 17);
 INSERT INTO GuestPhone VALUES('+15137640091', 17);
 INSERT INTO GuestPhone VALUES('+18327761236', 18);
 INSERT INTO GuestPhone VALUES('+18327619908', 18);
 INSERT INTO GuestPhone VALUES('+14143242567', 19);
 INSERT INTO GuestPhone VALUES('+14143241239', 19);


 INSERT INTO CheckIn VALUES( '08:00:00', '2019-12-1', 10, 'A90');
 INSERT INTO CheckIn VALUES( '11:00:00', '2019-12-4', 11, 'A91');
 INSERT INTO CheckIn VALUES( '13:45:00', '2019-12-15', 12, 'A92');
 INSERT INTO CheckIn VALUES( '15:00:00', '2019-12-30', 13, 'A93');
 INSERT INTO CheckIn VALUES( '15:30:00', '2020-01-1', 14, 'A94');
 INSERT INTO CheckIn VALUES( '16:00:00', '2020-01-13', 15, 'A95');
 INSERT INTO CheckIn VALUES( '18:45:00', '2020-01-17', 16, 'A96');
 INSERT INTO CheckIn VALUES( '20:00:00', '2020-02-03', 17, 'A97');
 INSERT INTO CheckIn VALUES( '21:30:00', '2020-02-12', 18, 'A98');
 INSERT INTO CheckIn VALUES( '21:45:00', '2020-02-13', 19, 'A99');


 INSERT INTO CheckOut VALUES( '10:00:00', '2020-01-3', 10, 'A90');
 INSERT INTO CheckOut VALUES( '15:00:00', '2020-01-8', 11, 'A91');
 INSERT INTO CheckOut VALUES( '13:45:00', '2020-01-18', 12, 'A92');
 INSERT INTO CheckOut VALUES( '17:00:00', '2020-02-4', 13, 'A93');
 INSERT INTO CheckOut VALUES( '04:30:00', '2020-02-12', 14, 'A94');
 INSERT INTO CheckOut VALUES( '20:00:00', '2020-02-18', 15, 'A95');
 INSERT INTO CheckOut VALUES( '02:45:00', '2020-03-14', 16, 'A96');
 INSERT INTO CheckOut VALUES( '10:00:00', '2020-03-19', 17, 'A97');
 INSERT INTO CheckOut VALUES( '21:30:00', '2020-03-25', 18, 'A98');
 INSERT INTO CheckOut VALUES( '13:45:00', '2020-03-30', 19, 'A99');

 INSERT INTO Booking VALUES('EA76543', '2019-09-3', 100);
 INSERT INTO Booking VALUES('BA64328', '2019-08-30', 100);
 INSERT INTO Booking VALUES('FE70921', '2019-09-20', 101);
 INSERT INTO Booking VALUES('ED36081', '2019-10-5', 101);
 INSERT INTO Booking VALUES('OA43097', '2019-10-30', 102);
 INSERT INTO Booking VALUES('KP85230', '2019-09-15', 102);
 INSERT INTO Booking VALUES('UT63092', '2019-11-17', 103);
 INSERT INTO Booking VALUES('ZA44903', '2019-11-19', 103);
 INSERT INTO Booking VALUES('EM11034', '2019-11-25', 104);
 INSERT INTO Booking VALUES('JR76390', '2019-12-9', 104);
 INSERT INTO Booking VALUES('BE96478', '2019-12-11', 105);
 INSERT INTO Booking VALUES('KJ85321', '2019-12-15', 105);
 INSERT INTO Booking VALUES('LM98235', '2019-12-17', 106);
 INSERT INTO Booking VALUES('UV87651', '2019-12-13', 106);
 INSERT INTO Booking VALUES('IJ41325', '2019-12-18', 107);
 INSERT INTO Booking VALUES('KU93712', '2019-12-21', 107);
 INSERT INTO Booking VALUES('MN80230', '2019-12-25', 108);
 INSERT INTO Booking VALUES('PY41423', '2019-12-28', 108);
 INSERT INTO Booking VALUES('FJ71009', '2020-01-9', 109);
 INSERT INTO Booking VALUES('JP10006', '2020-01-13', 109);

 INSERT INTO Payment VALUES(15432, 'Credit Card', '77413759988', 10);
 INSERT INTO Payment VALUES(15433, 'Debit Card', '65775324789', 11);
 INSERT INTO Payment VALUES(15434, 'Credit Card', '86357623980', 12);
 INSERT INTO Payment VALUES(15435, 'Credit Card', '63249851236', 13);
 INSERT INTO Payment VALUES(15436, 'Credit Card', '71457341232', 14);
 INSERT INTO Payment VALUES(15437, 'Debit Card', '75234512367', 15);
 INSERT INTO Payment VALUES(15438, 'Credit Card', '98643217865', 16);
 INSERT INTO Payment VALUES(15439, 'Credit Card', '77321987650', 17);
 INSERT INTO Payment VALUES(15440, 'Debit Card', '85438760984', 18);
 INSERT INTO Payment VALUES(15441, 'Credit Card', '97543219867', 19);


 INSERT INTO SoldVia VALUES('EA76543', 15432);
 INSERT INTO SoldVia VALUES('ED36081', 15433);
 INSERT INTO SoldVia VALUES('OA43097', 15434);
 INSERT INTO SoldVia VALUES('UT63092', 15435);
 INSERT INTO SoldVia VALUES('JR76390', 15436);
 INSERT INTO SoldVia VALUES('BE96478', 15437);
 INSERT INTO SoldVia VALUES('UV87651', 15438);
 INSERT INTO SoldVia VALUES('IJ41325', 15439);
 INSERT INTO SoldVia VALUES('MN80230', 15440);
 INSERT INTO SoldVia VALUES('JP10006', 15441);

 SELECT * FROM Hotel;
 SELECT * FROM Building;
 SELECT * FROM Room;
 SELECT * FROM Guest;
 SELECT * FROM GuestPhone;
 SELECT * FROM CheckIn;
 SELECT * FROM CheckOut;
 SELECT * FROM Booking;
 SELECT * FROM Payment;
 SELECT * FROM SoldVia;
 



 CREATE NONCLUSTERED INDEX nonCluster_HId
 ON Hotel(HId)
 GO

 CREATE NONCLUSTERED INDEX nonCluster_BuildId
 ON Building(BuildId)
 GO

 CREATE NONCLUSTERED INDEX nonCluster_RoomNo
 ON Room(RoomNo)
 GO

 CREATE NONCLUSTERED INDEX nonCluster_GId
 ON Guest(GId)
 GO

 CREATE NONCLUSTERED INDEX nonCluster_PId
 ON Payment(PId)
 GO

 CREATE NONCLUSTERED INDEX nonCluster_BookId
 ON Booking(BookId)
 GO

 CREATE NONCLUSTERED INDEX nonCluster_FullName
 ON Guest(FName, LName)
 GO

 CREATE NONCLUSTERED INDEX nonCluster_GId
 ON GuestPhone(GId)
 GO

 CREATE NONCLUSTERED INDEX nonCluster_GId
 ON CheckIn(GId)
 GO

 CREATE NONCLUSTERED INDEX nonCluster_GId
 ON CheckOut(GId)
 GO